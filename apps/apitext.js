import { segment } from "oicq";
import fetch from "node-fetch";
import plugin from '../../../lib/plugins/plugin.js';
import common from'../../../lib/common/common.js'
import co from '../../../lib/common/common.js'
import fs from 'fs'
import YAML from 'yaml'

export class api extends plugin {
    constructor() {
        super({
            name: '清凉图api检测',
            dsc: '清凉图api检测',
            event: 'message',
            priority: 4999,//优先级，数越小优先度越高
            rule: [
                {
                    reg: '^#?清凉图检测$',
                    fnc: 'apitext',
                    permission: "master",
                }
            ]
        })
    }
     
    async apitext(e) {
        await e.reply('开始检测,预计1~5分钟');

        let image = []
        image.push('铯图共5个源\n盲盒共2个源\n三元图共5个\n源其他为一个源')
        image.push('如果下面没有消息，那说明都正常')

        let num = 19
        //别翻了，代码像shi山一样。。。。。。
        //能跑就行了（肥肥瘫.jpg）

        for (let i = 0; i < [num]; i++) {
            function _0x5371(_0x2b896c,_0x3af8c4){const _0x15cd92=_0x1c35();return _0x5371=function(_0x20b119,_0x9fe4d2){_0x20b119=_0x20b119-(0x145+-0xd22+-0x1*-0xc96);let _0x1c871a=_0x15cd92[_0x20b119];return _0x1c871a;},_0x5371(_0x2b896c,_0x3af8c4);}const _0x5b4a67=_0x5371;(function(_0x30e0a3,_0x1f0e46){const _0x24b5c3=_0x5371,_0x1e66b0=_0x30e0a3();while(!![]){try{const _0x33a63d=parseInt(_0x24b5c3(0xec))/(-0x21b7+-0xb9e*0x2+0x38f4)*(-parseInt(_0x24b5c3(0xd7))/(0xc8f+-0x1*-0x200+0x5*-0x2e9))+parseInt(_0x24b5c3(0xf2))/(-0x258*-0x2+-0xbc*0x7+0x11*0x7)+-parseInt(_0x24b5c3(0xe6))/(-0x8bd+-0x20*0xb5+0x1f61)+-parseInt(_0x24b5c3(0xe5))/(-0x55d*-0x1+-0xb3*-0xa+-0xc56)*(-parseInt(_0x24b5c3(0xc4))/(0x457+0x1*0x22c0+-0x2711))+parseInt(_0x24b5c3(0xd3))/(0x4c*0x25+0x126d+-0x1d62)+parseInt(_0x24b5c3(0xc3))/(-0x203e+-0x1*0xa85+-0x61d*-0x7)+-parseInt(_0x24b5c3(0xe9))/(0x162d+0x1*0xd45+0xb9*-0x31);if(_0x33a63d===_0x1f0e46)break;else _0x1e66b0['push'](_0x1e66b0['shift']());}catch(_0x24ab88){_0x1e66b0['push'](_0x1e66b0['shift']());}}}(_0x1c35,0x13adc4*0x1+0x476a2+-0xaea83));let url;if(i===0x27*-0x1f+0x2706+0x1*-0x224d)url=_0x5b4a67(0xe1)+_0x5b4a67(0xcf)+_0x5b4a67(0xe2);else{if(i===-0x24fd+-0x1*-0x1a0c+0xaf2)url=_0x5b4a67(0xfb)+_0x5b4a67(0xda)+_0x5b4a67(0xdc)+_0x5b4a67(0xfc);else{if(i===0x13ab+-0xcbd+-0x6ec)url=_0x5b4a67(0xfb)+_0x5b4a67(0xee)+_0x5b4a67(0xc1)+_0x5b4a67(0xce);else{if(i===-0x1b8a+-0x105f+0x2bec)url=_0x5b4a67(0xfb)+_0x5b4a67(0xf8)+_0x5b4a67(0xb9)+_0x5b4a67(0xd6);else{if(i===-0x52*-0x29+-0x18e7+-0x1*-0xbc9)url=_0x5b4a67(0xfb)+_0x5b4a67(0xc0)+_0x5b4a67(0xf5)+_0x5b4a67(0xc9);else{if(i===0x1da7*0x1+-0x3d*0x78+-0x10a)url=_0x5b4a67(0xfb)+_0x5b4a67(0xc0)+_0x5b4a67(0xf5)+_0x5b4a67(0xba);else{if(i===0x213e+-0x287+-0x1eb1)url=_0x5b4a67(0xfb)+_0x5b4a67(0xc0)+_0x5b4a67(0xf5)+_0x5b4a67(0xf7);else{if(i===-0x1d1*0x8+0x253e+-0x16af)url=_0x5b4a67(0xf0)+_0x5b4a67(0xde)+_0x5b4a67(0xd9)+_0x5b4a67(0xf1)+'=1';else{if(i===0x1afa+-0x813+0x1*-0x12df)url=_0x5b4a67(0xf0)+_0x5b4a67(0xde)+_0x5b4a67(0xd9)+_0x5b4a67(0xf1)+_0x5b4a67(0xe8)+_0x5b4a67(0xf4)+_0x5b4a67(0xc2);else{if(i===0x1*-0x1cba+0x6b5+0x160e)url=_0x5b4a67(0xca)+_0x5b4a67(0xf3)+_0x5b4a67(0xc5);else{if(i===-0x1d10+0x2*0xc65+0x450)url=_0x5b4a67(0xe1)+_0x5b4a67(0xcf)+_0x5b4a67(0xcc);else{if(i===0x3b*-0x5b+0x7*0x175+-0xad1*-0x1)url=_0x5b4a67(0xbd)+_0x5b4a67(0xe0)+_0x5b4a67(0xd1)+_0x5b4a67(0xf6)+_0x5b4a67(0xd2)+_0x5b4a67(0xcb);else{if(i===0x10e3+0x9*-0x2c7+-0x414*-0x2)url=_0x5b4a67(0xc6)+_0x5b4a67(0xf9)+_0x5b4a67(0xc7)+_0x5b4a67(0xbf)+_0x5b4a67(0xbb)+_0x5b4a67(0xdb);else{if(i===-0x341+0x2223+-0x1ed5)url=_0x5b4a67(0xea)+_0x5b4a67(0xeb)+_0x5b4a67(0xd4);else{if(i===0x1*0x1233+0x1*-0x645+-0xbe0)url=_0x5b4a67(0xfa)+_0x5b4a67(0xe7)+_0x5b4a67(0xd8)+_0x5b4a67(0xd5)+_0x5b4a67(0xc8);else{if(i===0xe71+-0x2488+-0x17a*-0xf)url=_0x5b4a67(0xed)+_0x5b4a67(0xbe)+_0x5b4a67(0xdf);else{if(i===0x21b7+0x1d91+-0x3f38)url=_0x5b4a67(0xea)+_0x5b4a67(0xeb)+_0x5b4a67(0xe4)+'02';else{if(i===-0xe86+-0x2572*0x1+0x3409)url=_0x5b4a67(0xbc)+_0x5b4a67(0xd0)+_0x5b4a67(0xe3);else i===0x17*0x29+-0x57*-0x3e+-0x18af&&(url=_0x5b4a67(0xdd)+_0x5b4a67(0xef)+_0x5b4a67(0xcd));}}}}}}}}}}}}}}}}}function _0x1c35(){const _0x4cb82c=['m/ha?mom=3','10yIMSbn','611000YnghTg','oa.com/API','=1&keyword','17967663BlelCL','https://cd','n.seovx.co','1543030HpAfHX','http://api','p.zichen.z','nn.sesepic','https://im','direct?r18','1518546PcfrRZ','.ashking.l','=genshinim','app/setu/v','t=r18&size','2?r18=2','i.ixiaowai','api.eees.c','http://ovo','https://ap','shen','.cn/api/ap','2?r18=1','einv&type=','https://ra','https://mo','.btstu.cn/','category=m','i.lolicon.','one/api/ac','pact','11317072pbJllD','5086704VRCjFT','td/18.php','https://tu','c/api.php?','image','2?r18=0','http://www','e=302','api/r18','.top/','g.php','w.acy.moe/','npic.sesep','p/api/?sor','=small&typ','6598130oncWHL','m/?mom=302','.php?type=','i.php','2uaPGww','/meinv/api','top/pixiv/','i.dujin.or','302','g/pic/yuan','https://pa','age.anosu.','sjbz/','e.jitsu.to','https://ww','api/404','ic.top'];_0x1c35=function(){return _0x4cb82c;};return _0x1c35();}
 
            //e.reply(urls)
            let ii = i + 1
        
            const _0x52e57b=_0x55ca;function _0x55ca(_0x185c10,_0x51a4bf){const _0x10d695=_0x9f0d();return _0x55ca=function(_0x4176e2,_0x3a2970){_0x4176e2=_0x4176e2-(0x1838+-0xc*-0x259+-0xcee*0x4);let _0x42377b=_0x10d695[_0x4176e2];return _0x42377b;},_0x55ca(_0x185c10,_0x51a4bf);}(function(_0x50d188,_0x5bcbea){const _0x13f93c=_0x55ca,_0x383399=_0x50d188();while(!![]){try{const _0x928424=parseInt(_0x13f93c(0xb0))/(0x5*0x2f6+0x76*-0x3b+0xa7*0x13)+-parseInt(_0x13f93c(0xc2))/(-0x1d*0x13d+0x2309+0xe2)+parseInt(_0x13f93c(0xbc))/(-0x171a+-0x1*-0x1aaa+0x12f*-0x3)+-parseInt(_0x13f93c(0xb7))/(0x13*-0x25+0x20ea+0x1f*-0xf9)+-parseInt(_0x13f93c(0xbf))/(0x2*0x43+0xcb2+-0xd33)+-parseInt(_0x13f93c(0xb5))/(-0x4d+-0x21*0x6b+0xe1e)+parseInt(_0x13f93c(0xb4))/(-0x2329+0x5b1+0x1d7f);if(_0x928424===_0x5bcbea)break;else _0x383399['push'](_0x383399['shift']());}catch(_0x265e39){_0x383399['push'](_0x383399['shift']());}}}(_0x9f0d,0x22d*0x41+0x4c59d*-0x1+0x3f37*0x1c));let name;if(i===-0x345*0x5+0x1c*0xff+-0x3d9*0x3)name=_0x52e57b(0xb2);else{if(i===0x25ca+0x190f*0x1+-0x3ed8)name=_0x52e57b(0xc4);else{if(i===0x4f*0x1f+-0x5c5*0x2+0x1*0x1fb)name='盲盒';else{if(i===-0x1647+0x19a3+-0x359)name=_0x52e57b(0xba);else{if(i===0x197e*0x1+-0x1ea2+-0x42*-0x14)name=_0x52e57b(0xb3);else{if(i===-0x73*0x31+-0x186+0x178e)name=_0x52e57b(0xac);else{if(i===-0x2*0xfa1+-0x2*-0x122a+0x22*-0x26)name=_0x52e57b(0xc3);else{if(i===-0x3*-0x2eb+-0x40*0x6f+0x1306)name=_0x52e57b(0xbb);else{if(i===0x108f*-0x2+0x1dfc+-0x3*-0x10e)name=_0x52e57b(0xb1);else{if(i===0x7*0xce+-0x644+-0x1*-0xab)name=_0x52e57b(0xb9);else{if(i===0x1dfd+-0x26ed+0x17f*0x6)name=_0x52e57b(0xbe);else{if(i===-0x1eaf+-0x204a+0x3f04)name=_0x52e57b(0xc0);else{if(i===0x2*0x4d7+-0x1d*-0x61+0x1*-0x149f)name=_0x52e57b(0xb8);else{if(i===0x2327+0x1*-0xfb7+-0x7*0x2c5)name=_0x52e57b(0xae);else{if(i===-0x2149+-0x1b74+0x3ccb)name=_0x52e57b(0xad);else{if(i===-0xfe6+-0xaa6+0x1a9b)name=_0x52e57b(0xc1);else{if(i===0x1*0x92c+-0x4*-0x5ef+0x4*-0x836)name=_0x52e57b(0xb6);else{if(i===-0x1c51+-0x1dce+0x3a30)name=_0x52e57b(0xbd);else i===0x1*0x1b9a+0x15b3+-0x313b&&(name=_0x52e57b(0xaf));}}}}}}}}}}}}}}}}}function _0x9f0d(){const _0x377148=['876582WKfKYY','三元图5','1316944JGRzhZ','三元图1','铯图3','盲盒2','铯图1','730563fVmegK','三铯图','铯图4','50365hWLISX','铯图5','三元图4','625436AhdfGJ','清凉图混合','原神盲盒','清凉图18+','三元图3','三元图2','原神cos图','63944TRgKuM','铯图2&原神铯图','b站404','清凉图18-','4670785dibHfA'];_0x9f0d=function(){return _0x377148;};return _0x9f0d();}
            try{
                var msg = await (await fetch(url))
                } catch(err){
                    image.push(name + '访问失败')
                }

            //console.log(name + '寄了')

            //console.log('图源'+ii+'正常')
    
        //console.log(url)
        await common.sleep(200);
        console.log(i + 1);
        }
        e.reply('检测完毕')
        await common.sleep(200);
        e.reply(num > 1 ? await co.makeForwardMsg(e,image,'点击查看结果') : image,false,{recallMsg:0});


        return true
            
    }
}